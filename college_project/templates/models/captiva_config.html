{% extends 'layout.html' %}
{% load static %}

{% block content %}

<section class="config-page">
    <div class="config-back">
        <a href="{% url 'cars_list' %}">
            ‚Üê Ro'yxatga qaytish
        </a>
    </div>
<div class="config-container">

    <!-- LEFT SIDE -->
    <div class="config-left">

        <img id="mainCar"
             src="{% static 'images/captiva/captiva_black.png' %}"
             alt="Captiva">

        <!-- SPECS -->
        <div class="car-specs">
            <div><span>Dvigatel quvvati</span><strong>149 o.k.</strong></div>
            <div><span>0-100 km/soat</span><strong>13,6 sek</strong></div>
            <div><span>100 km yoqilg‚Äòi</span><strong>11,6 L</strong></div>
            <div><span>Uzatmalar qutisi</span><strong>CVT</strong></div>
        </div>
        <!-- ================= TECHNICAL FEATURES ================= -->

<section class="tech-section">

    <!-- Top Bar -->
    <div class="tech-header">
        <div class="tech-title">
            <div class="tech-icon">üìÑ</div>
            <div>
                <h3>Texnik xususiyatlar</h3>
                <p>Texnik xususiyatlar, komplektatsiya va hujjatlar</p>
            </div>
        </div>

        <a href="#" class="download-btn">
            ‚¨á Xarakteristikani yuklash
        </a>
    </div>


    <!-- Content -->
    <div class="tech-content">

        <!-- Left Menu -->
        <div class="tech-menu">

            <div class="tech-tab active">Tasvir</div>
            <div class="tech-tab">Eksteryer</div>
            <div class="tech-tab">Interyer</div>
            <div class="tech-tab">Xavfsizlik</div>
            <div class="tech-tab">Multimedia va texnologiyalar</div>

        </div>

        <!-- Right Content -->
        <div class="tech-display">

            <img src="{% static 'images/captiva/captiva_gray.png' %}" alt="Captiva">

            <p>
                Krossoverning flagman modifikatsiyasi keng, texnologik va premium
                qulayliklarni birlashtiradi. 7 o‚Äòrindiqli salon, panoramali tom,
                nafas oluvchi ekocharmlik salon qoplamasi va maksimal opsiyalar
                ushbu modifikatsiyani katta oila va obro‚Äò-e‚Äôtibor qadrlaydiganlar
                uchun ideal tanlovga aylantiradi.
            </p>

        </div>

    </div>

</section>

    </div>

    <!-- RIGHT SIDE -->
    <div class="config-right">

        <h2>CAPTIVA</h2>
        <p class="subtitle">Modifikatsiya va rangni tanlang</p>

        <!-- TABS -->
        <div class="config-tabs">
            <div class="tab active">Konfiguratsiya</div>
            <div class="tab">Muddatli to‚Äòlov kalkulyatori</div>
        </div>

        <!-- MODIFICATION -->
        <div class="card-box">

    <h4>Modifikatsiya</h4>

    <div class="mod-option"
         data-model="lt2">
        <span>LT 2</span>
        <strong>304,900,000 so'm</strong>
    </div>

    <div class="mod-option active"
         data-model="premier">
        <span>PREMIER</span>
        <strong>334,900,000 so'm</strong>
    </div>

</div>

        <!-- COLORS -->
        <div class="card-box">

            <h4>Rangni tanlang</h4>

            <div class="color-grid">

    <!-- WHITE (Available for LT2 + Premier) -->
    <div class="color-box active"
         data-name="White"
         data-models="lt2,premier"
         data-img="{% static 'images/captiva/captiva_white.png' %}"
         style="background:#dcdcdc;">
    </div>

    <!-- BLACK (Premier only) -->
    <div class="color-box"
         data-name="Black"
         data-models="premier"
         data-img="{% static 'images/captiva/captiva_black.png' %}"
         style="background:#000;">
    </div>

    <!-- RED (Premier only) -->
    <div class="color-box"
         data-name="Red"
         data-models="premier"
         data-img="{% static 'images/captiva/captiva_red.png' %}"
         style="background:#d20f2a;">
    </div>

    <!-- GRAY (Premier only) -->
    <div class="color-box"
         data-name="Gray"
         data-models="premier"
         data-img="{% static 'images/captiva/captiva_gray.png' %}"
         style="background:#6f7a86;">
    </div>

</div>

<p class="color-name" id="colorName">White</p>


        <!-- DEALER -->
        <div class="card-box">

        </div>

    </div>

</div>

</section>

{% endblock %}

{% block scripts %}

<script>

const colors = document.querySelectorAll(".color-box");
const mods = document.querySelectorAll(".mod-option");
const car = document.getElementById("mainCar");
const colorName = document.getElementById("colorName");

let currentModel = "premier";

/* ================= MODIFICATION SWITCH ================= */

mods.forEach(mod => {
    mod.addEventListener("click", function(){

        mods.forEach(m => m.classList.remove("active"));
        this.classList.add("active");

        currentModel = this.dataset.model;

        updateColors();
    });
});

/* ================= UPDATE COLORS ================= */

function updateColors() {

    let firstAvailable = null;

    colors.forEach(color => {

        const allowedModels = color.dataset.models.split(",");

        if (allowedModels.includes(currentModel)) {

            color.style.display = "block";

            if (!firstAvailable) {
                firstAvailable = color;
            }

        } else {

            color.style.display = "none";
            color.classList.remove("active");

        }
    });

    // Auto select first available color
    if (firstAvailable) {

        colors.forEach(c => c.classList.remove("active"));
        firstAvailable.classList.add("active");

        car.src = firstAvailable.dataset.img;
        colorName.innerText = firstAvailable.dataset.name;
    }
}

/* ================= COLOR CLICK ================= */

colors.forEach(color => {
    color.addEventListener("click", function(){

        if (this.style.display === "none") return;

        colors.forEach(c => c.classList.remove("active"));
        this.classList.add("active");

        car.src = this.dataset.img;
        colorName.innerText = this.dataset.name;
    });
});

</script>


{% endblock %}
